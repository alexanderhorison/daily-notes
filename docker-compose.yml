services:
  app:
    image: ${CONTAINER_NAME:-daily-notes-app}:latest
    container_name: ${CONTAINER_NAME:-daily-notes-app}
    build:
      context: .
      dockerfile: Dockerfile
      args:
        PORT: ${PORT:-8003}
        VITE_CLERK_PUBLISHABLE_KEY: ${VITE_CLERK_PUBLISHABLE_KEY}
        VITE_CLERK_JWT_TEMPLATE: ${VITE_CLERK_JWT_TEMPLATE}
        VITE_SUPABASE_URL: ${VITE_SUPABASE_URL}
        VITE_SUPABASE_PUBLISHABLE_KEY: ${VITE_SUPABASE_PUBLISHABLE_KEY}
        VITE_SUPABASE_ANON_KEY: ${VITE_SUPABASE_ANON_KEY}
    restart: unless-stopped
    env_file:
      - .env
    ports:
      - "${PORT:-8003}:${PORT:-8003}"
    environment:
      - APP_PORT=${PORT:-8003}
    networks:
      - tunnel

networks:
  tunnel:
    external: true
